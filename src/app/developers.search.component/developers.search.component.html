<div class="container">
  <header class="header">
    <h1>DevHub</h1>
  </header>

  <div class="filter-section">
    <input
      type="search"
      placeholder="Search developers by name or skills..."
      [formControl]="searchControl"
    />
  </div>

  <div class="developer-count">{{ filteredDevelopers?.length || 0 }} Developers Found</div>

  <div class="developer-cards">
    <div *ngFor="let developer of filteredDevelopers" class="card">
      <div class="img-wrapper">
        <img
          [src]="getProfileImage(developer.profileImage)"
          alt="Profile Image"
          class="profile-img"
          (error)="onImageError($event)"
        />
      </div>

      <h3>{{ developer.first_name }} {{ developer.last_name }}</h3>

      <div class="skill-list">
        <ng-container *ngFor="let skill of developer.skills; let j = index">
          <p *ngIf="j < 3" class="skill">{{ skill }}</p>
          <p *ngIf="j === 3" class="skill">etc...</p>
        </ng-container>
      </div>

      <div class="card-btns">
        <button type="button" class="profile-button" (click)="openProfile(developer.id)">
          View Profile
        </button>
        <button
          type="button"
          class="add-button"
          [ngClass]="{ selected: isSelected(developer.id) }"
          (click)="selectDeveloper(developer)"
        >
          {{ isSelected(developer.id) ? "✓ Selected" : "+" }}
        </button>
      </div>
    </div>
  </div>

  <!-- Profile popup -->
  <div class="profile-modal-backdrop" *ngIf="selectedProfileId" (click)="closeProfile()"></div>

  <div class="profile-modal" *ngIf="selectedProfileId" (click)="$event.stopPropagation()">
    <iframe
      [src]="'/profile/user/' + selectedProfileId | safeUrl"
      frameborder="0"
      class="profile-iframe"
    ></iframe>
    <button type="button" class="close-profile" (click)="closeProfile()">×</button>
  </div>
</div>
